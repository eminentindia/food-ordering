function applycoupon(){var e=$("#couponcode").val();""==e?Swal.fire({icon:"error",title:"Oops...",text:"Please Enter Coupon Code",toast:!0,position:"top-end",showConfirmButton:!1,timer:4e3,background:"#ff9999"}):$.ajax({type:"post",url:"action/check-coupon.php",data:"couponcode="+e,success:function(e){"success"==(e=JSON.parse(e)).status?(Swal.fire({icon:"success",title:"Success",text:e.msg,toast:!0,position:"top-end",showConfirmButton:!1,timer:4e3,background:"#99ff99"}),jQuery(".shopping-cart-total").show(),$("#couponsuccess").html(e.msg),jQuery(".final_price").html("Rs. "+e.coupon_code_apply),jQuery(".coupon_code_str").html(" Rs. "+e.value),$(".coupon-btn").html("UPDATE"),$("#couponsuccess").show()):"percent"==e.status?(Swal.fire({icon:"success",title:"Success",text:e.msg,toast:!0,position:"top-end",showConfirmButton:!1,timer:4e3,background:"#99ff99"}),jQuery(".shopping-cart-total").show(),$("#couponsuccess").html(e.msg),jQuery(".final_price").html(" Rs. "+e.coupon_code_apply),jQuery(".coupon_code_str").html(e.value+"%"),$("#couponsuccess").show()):"error"==e.status&&(Swal.fire({icon:"error",title:"Oops...",text:e.msg,toast:!0,position:"top-end",showConfirmButton:!1,timer:4e3,background:"#ff9999"}),$("#couponerror").delay(4e3).fadeOut("slow"),$("#couponerror").show())}})}function OTPInput(){const e=document.querySelectorAll("#otp > *[id]");for(let t=0;t<e.length;t++)e[t].addEventListener("input",(function(o){const n=o.data;if("deleteContentBackward"===o.inputType||"Backspace"===o.key)null!==n&&""!==n||0!==t&&(e[t-1].value="",e[t-1].focus());else{if(t===e.length-1&&null!==n&&""!==n)return!0;/^[0-9a-zA-Z]$/.test(n)&&(e[t].value=n,t!==e.length-1&&e[t+1].focus())}})),e[t].addEventListener("keydown",(function(o){"Backspace"===o.key&&0!==t&&""===e[t].value&&(e[t-1].value="",e[t-1].focus())}))}function initializeResendButton(){var e,t=1,o=document.getElementById("ResendOTP"),n=10;function i(){o.setAttribute("disabled","disabled"),o.innerHTML="Resend ("+t+"/3)",n=10,e=setInterval((function(){if(--n>=0){var i=n;o.innerHTML="Resend ("+(i<10?"0":"")+i+")"}else clearInterval(e),t<3?(o.removeAttribute("disabled"),o.innerHTML="Resend"):o.remove()}),1e3)}o.addEventListener("click",(function(){o.hasAttribute("disabled")||++t<=3&&i()})),i()}function showError(e){Swal.fire({icon:"error",title:"Oops...",text:e,toast:!0,position:"top-end",showConfirmButton:!1,timer:4e3,background:"#ff9999"})}$(document).ready((function(){$("#loginformwithmobile").validate({rules:{phone:{required:!0,rangelength:[10,10],number:!0}},highlight:function(e){$(e).addClass("error")},unhighlight:function(e){$(e).removeClass("error")},errorPlacement:function(e,t){},submitHandler:function(e){var t=$("#loginmobile").val();$("#sendotp").attr("disabled",!0),$("#sendotp").html("Please Wait..."),$.ajax({type:"POST",url:"action/send_login_otp.php",data:{phone:t},success:function(e){"success"===e.status?($("#loginmobile").attr("disabled",!0),$("#sendotp").attr("disabled",!1),$("#sendotp").html("Send OTP"),$("#otpBOX").html(e.html),$("#sendotp").hide(),OTPInput(),initializeResendButton()):($("#otpBOX").html(e.html),OTPInput(),initializeResendButton())}})}})})),$(document).on("click",".validatethis",(function(e){var t=$("#loginmobile").val();e.preventDefault();const o=document.querySelectorAll("#otp input"),n=[];o.forEach((function(e){const t=parseInt(e.value);isNaN(t)||n.push(t)}));const i=n.join("");$(".validatethis").prop("disabled",!0).html("Please Wait..."),$.ajax({type:"post",url:"action/validate_otp.php",data:{numbers:i,loginmobile:t},success:function(e){if("success"==e.trim()){$("#otpBOX").html('<div class="alert alert-success d-flex align-items-center" role="alert"><div>OTP VALIDATED SUCCESSFULLY !! Redirecting...</div></div>'),setTimeout((function(){location.reload()}),1e3)}else{$("#invalidotp").html('<div class="alert alert-warning d-flex align-items-center" role="alert"><div>INVALID OTP !!</div></div>')}},complete:function(){$(".validatethis").prop("disabled",!1).html("Continue")}})})),$(document).ready((function(){$("#checkmain").validate({rules:{fname:{required:!0},phone:{required:!0,rangelength:[10,12],number:!0},zip:{required:!0,number:!0},address:{required:!0},city:{required:!0},email:{required:!0,email:!0},time_slot:{required:!0},delievery_date:{required:!0}},highlight:function(e){$(e).addClass("error")},unhighlight:function(e){$(e).removeClass("error")},errorPlacement:function(e,t){},submitHandler:function(e){var t=$("#zip").val(),o=$("#Delhi").val(),n=$('input[name="delieverytype"]:checked').val();if(0==$('input[name="store"]:checked').length)return showError("Please Choose your Nearest Outlet !!"),$('input[name="store"]').focus(),!1;if("110001"!==t&&"Delivery"==n)return showError("We Only Deliver in 110001, BARAKHAMBA ROAD, KG MARG & CONNAUGHT PLACE"),$("#zip").focus(),!1;if("Delhi"!==o)return showError("We only deliver in Delhi"),$("#Delhi").focus(),!1;if(0==$('input[name="terms"]:checked').length)return showError("Please Accept Terms and Conditions !!"),$('input[name="terms"]').focus(),!1;var i=$('input[name="payment_type"]:checked').val();return""!==i?($(".finalcheckout").prop("disabled",!0).html('<div style="width: 1rem !important; height: 1rem !important;" class="spinner-grow" role="status"><span class="sr-only">Loading...</span></div> Processing...'),"online"==i?($(".maincheckout").attr("value","Processing..."),$(".maincheckout").attr("disabled",!0),e.submit(),$(".maincheckout").attr("disabled",!1)):"cod"==i?$.post(SITE_PATH+"action/check_order.php",$("#checkmain").serialize()).done((function(e){window.location.href=SITE_PATH+"success?ORDER_ID="+e})).fail((function(){showError("Something Went Wrong. Please Try Again")})).always((function(){$(".finalcheckout").prop("disabled",!1).html("Checkout")})):showError("Please Choose Payment Mode"),!1):(showError("Please Choose Payment Mode"),!1)}})}));
